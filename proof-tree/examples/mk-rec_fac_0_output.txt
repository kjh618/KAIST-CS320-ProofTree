                                                                                                                                                                                                                                                                                                       body-proc ∈ [body-proc, fY, f]                          f ∈ [body-proc, fY, f]                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                     ――――――――――――――――――――――――――――――――――――――――――――――――――――――  ――――――――――――――――――――――――――――――――――――――――――――――                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                       [body-proc ↦ v1, fY ↦ v2, f ↦ v3] ⊢ body-proc ⇒ v1      [body-proc ↦ v1, fY ↦ v2, f ↦ v3] ⊢ f ⇒ v3    [mk-rec ↦ v0, fac ↦ v3] ⊢ {fun {n} e3} ⇒ v4                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                   ―――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――                                                                                                                                                                                 
                                                                                                                                                         fX ∈ [body-proc, fX]                     fX ∈ [body-proc, fX]                     [body-proc ↦ v1, fY ↦ v2] ⊢ {fun {x} {{fY fY} x}} ⇒ v3    [body-proc ↦ v1, fY ↦ v2, f ↦ v3] ⊢ {body-proc f} ⇒ v4                                                                                                                                                                                                                                                                                
                                                                                                                                                       ―――――――――――――――――――――――――――――――――――――――  ―――――――――――――――――――――――――――――――――――――――  ―――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――                                                                                                                                                                               
                                                                                                                                                         [body-proc ↦ v1, fX ↦ v2] ⊢ fX ⇒ v2      [body-proc ↦ v1, fX ↦ v2] ⊢ fX ⇒ v2      [body-proc ↦ v1, fY ↦ v2] ⊢ {with {f e4} {body-proc f}} ⇒ v4                                                                                                                                                                                                                                            n ∈ [mk-rec, fac, n]                                                                    
                                                                                                                                                     ―――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――                                                                                   ――――――――――――――――――――――――――――――――――――――――――                                                
                                        mk-rec ∈ [mk-rec]                                                     [body-proc ↦ v1] ⊢ {fun {fY} e2} ⇒ v2    [body-proc ↦ v1, fX ↦ v2] ⊢ {fX fX} ⇒ v4                                                                                                                                                                                                                                                                         fac ∈ [mk-rec, fac]                                                        [mk-rec ↦ v0, fac ↦ v3, n ↦ 0] ⊢ n ⇒ 0    [mk-rec ↦ v0, fac ↦ v3, n ↦ 0] ⊢ 1 ⇒ 1        
                                      ―――――――――――――――――――――――――――――――                                       ――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――      ――――――――――――――――――――――――――――――――――――――                                   ――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――      
                                        [mk-rec ↦ v0] ⊢ mk-rec ⇒ v0    [mk-rec ↦ v0] ⊢ {fun {fac} e1} ⇒ v1    [body-proc ↦ v1] ⊢ {with {fX e5} {fX fX}} ⇒ v4                                                                                                                                                                                                                                                                                                            [mk-rec ↦ v0, fac ↦ v4] ⊢ fac ⇒ v4    [mk-rec ↦ v0, fac ↦ v4] ⊢ 0 ⇒ 0    [mk-rec ↦ v0, fac ↦ v3, n ↦ 0] ⊢ {if0 n 1 {* n {fac {- n 1}}}} ⇒ 1                        
                                    ――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――  ―――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――    
                                      [mk-rec ↦ v0] ⊢ {mk-rec e6} ⇒ v4                                                                                                                                                                                                                                                                                                                                                                                                [mk-rec ↦ v0, fac ↦ v4] ⊢ {fac 0} ⇒ 1                                                                                                                                
                                  ―――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――  
  [] ⊢ {fun {body-proc} e0} ⇒ v0    [mk-rec ↦ v0] ⊢ {with {fac e7} {fac 0}} ⇒ 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
―――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
  [] ⊢ {with {mk-rec e8} e9} ⇒ 1  
* e0 = {with {fX e5} {fX fX}}                   = {with {fX {fun {fY} {with {f {fun {x} {{fY fY} x}}} {body-proc f}}}} {fX fX}}
* e1 = {fun {n} e3}                             = {fun {n} {if0 n 1 {* n {fac {- n 1}}}}}
* e2 = {with {f e4} {body-proc f}}              = {with {f {fun {x} {{fY fY} x}}} {body-proc f}}
* e3 = {if0 n 1 {* n {fac {- n 1}}}}            = {if0 n 1 {* n {fac {- n 1}}}}
* e4 = {fun {x} {{fY fY} x}}                    = {fun {x} {{fY fY} x}}
* e5 = {fun {fY} e2}                            = {fun {fY} {with {f {fun {x} {{fY fY} x}}} {body-proc f}}}
* e6 = {fun {fac} e1}                           = {fun {fac} {fun {n} {if0 n 1 {* n {fac {- n 1}}}}}}
* e7 = {mk-rec e6}                              = {mk-rec {fun {fac} {fun {n} {if0 n 1 {* n {fac {- n 1}}}}}}}
* e8 = {fun {body-proc} e0}                     = {fun {body-proc} {with {fX {fun {fY} {with {f {fun {x} {{fY fY} x}}} {body-proc f}}}} {fX fX}}}
* e9 = {with {fac e7} {fac 0}}                  = {with {fac {mk-rec {fun {fac} {fun {n} {if0 n 1 {* n {fac {- n 1}}}}}}}} {fac 0}}
* v0 = ⟨λbody-proc.e0, []⟩                      = ⟨λbody-proc.{with {fX {fun {fY} {with {f {fun {x} {{fY fY} x}}} {body-proc f}}}} {fX fX}}, []⟩
* v1 = ⟨λfac.e1, [mk-rec ↦ v0]⟩                 = ⟨λfac.{fun {n} {if0 n 1 {* n {fac {- n 1}}}}}, [mk-rec ↦ ⟨λbody-proc.{with {fX {fun {fY} {with {f {fun {x} {{fY fY} x}}} {body-proc f}}}} {fX fX}}, []⟩]⟩
* v2 = ⟨λfY.e2, [body-proc ↦ v1]⟩               = ⟨λfY.{with {f {fun {x} {{fY fY} x}}} {body-proc f}}, [body-proc ↦ ⟨λfac.{fun {n} {if0 n 1 {* n {fac {- n 1}}}}}, [mk-rec ↦ ⟨λbody-proc.{with {fX {fun {fY} {with {f {fun {x} {{fY fY} x}}} {body-proc f}}}} {fX fX}}, []⟩]⟩]⟩
* v3 = ⟨λx.{{fY fY} x}, [body-proc ↦ v1, fY ↦ v2]⟩ = ⟨λx.{{fY fY} x}, [body-proc ↦ ⟨λfac.{fun {n} {if0 n 1 {* n {fac {- n 1}}}}}, [mk-rec ↦ ⟨λbody-proc.{with {fX {fun {fY} {with {f {fun {x} {{fY fY} x}}} {body-proc f}}}} {fX fX}}, []⟩]⟩, fY ↦ ⟨λfY.{with {f {fun {x} {{fY fY} x}}} {body-proc f}}, [body-proc ↦ ⟨λfac.{fun {n} {if0 n 1 {* n {fac {- n 1}}}}}, [mk-rec ↦ ⟨λbody-proc.{with {fX {fun {fY} {with {f {fun {x} {{fY fY} x}}} {body-proc f}}}} {fX fX}}, []⟩]⟩]⟩]⟩
* v4 = ⟨λn.e3, [mk-rec ↦ v0, fac ↦ v3]⟩         = ⟨λn.{if0 n 1 {* n {fac {- n 1}}}}, [mk-rec ↦ ⟨λbody-proc.{with {fX {fun {fY} {with {f {fun {x} {{fY fY} x}}} {body-proc f}}}} {fX fX}}, []⟩, fac ↦ ⟨λx.{{fY fY} x}, [body-proc ↦ ⟨λfac.{fun {n} {if0 n 1 {* n {fac {- n 1}}}}}, [mk-rec ↦ ⟨λbody-proc.{with {fX {fun {fY} {with {f {fun {x} {{fY fY} x}}} {body-proc f}}}} {fX fX}}, []⟩]⟩, fY ↦ ⟨λfY.{with {f {fun {x} {{fY fY} x}}} {body-proc f}}, [body-proc ↦ ⟨λfac.{fun {n} {if0 n 1 {* n {fac {- n 1}}}}}, [mk-rec ↦ ⟨λbody-proc.{with {fX {fun {fY} {with {f {fun {x} {{fY fY} x}}} {body-proc f}}}} {fX fX}}, []⟩]⟩]⟩]⟩]⟩